//! NArray.js
//! version : 0.4.20160312.1
//! author : Na Chao
//! license : FFF
//! github.com/nachao/NArray
!function(a,b){"use strict";b(a)}(Array.prototype,function(array,undefined){"use strict";function NArray(){}function each(a,b){var c,d;for(d in a)if(a.hasOwnProperty(d)&&(c=b(d,a[d])))break;return!!c}NArray.fn=NArray.prototype={};var caseSign=["<=",">=","<",">","!=","==","="];Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d,e,f;if(null==this)throw new TypeError('"this" is null or not defined');if(d=Object(this),e=d.length>>>0,0===e)return-1;if(f=+b||0,1/0===Math.abs(f)&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var c,b=[];for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),NArray.extend=NArray.fn.extend=function(a,b){return b||(b=a,a=this),each(b,function(b,c){a[b]=c}),a},NArray.extend({update:function(a,b){return"undefined"!=typeof b&&a.constructor==Array&&each(a,function(c,d){"object"==typeof b?NArray.extend(d,b):"function"==typeof b&&b.call(d,a.$path[c])&&NArray.extend(d,b.call(d,a.$path[c]))}),a},unique:function(a){var b=[];return each(a,function(a,c){b.indexOf(JSON.stringify(c))<0&&b.push(c)}),b},getInquiry:function(a){var b="";return a&&each(caseSign,function(c,d){return a.indexOf(d)>=0?(b=d,!0):void 0}),b},eachCondition:function(a){var b=[];return"string"==typeof a.value?a.value=a.value.split("|"):a.value&&a.value.constructor==Array||(a.value=[a.value]),each(a.value,function(c,d){"string"==typeof a.key&&(a.key=a.key.trim()),"string"==typeof d&&(d=d.trim()),b.push({key:"*"==a.key?"":a.key,val:"*"==d?"":d,mode:a.mode||"==",enable:a.enable||!0,strict:a.strict||!1})}),b},parseByString:function(a){var b=[],c=a?a.toString().split(","):[];return each(c,function(a,c){var d=NArray.getInquiry(c),e=c.split(d),f=e[0],g=e[1];d||g||(g=f||"",f=""),b=b.concat(NArray.eachCondition({key:f,value:g.split("|"),mode:d}))}),b},parseByObject:function(a){var b=[];return a.constructor==Object&&(a=[a]),each(a,function(a,c){b=b.concat(NArray.eachCondition(c))}),b},parseCondition:function(a){var b=[];return"string"==typeof a?b=NArray.parseByString(a):(a.constructor==Array||a.constructor==Object)&&(b=NArray.parseByObject(a)),b},mateEnter:function(a,b,c,d){var e=[];return d&&(c="whole "+c),a.constructor!=Array&&(a=[a]),e.constructor.prototype.$path=[],a&&NArray.mateDepth(c,b,a,e),e},mateDepth:function(a,b,c,d,e,f,g){var h=[],i=[];NArray.extend(i,f||[]),NArray.extend(h,e||[]),c&&[Function,Object,Array].indexOf(c.constructor)>-1&&("undefined"!=typeof g&&i.push(g),h.push(c),NArray.mateCondition(a,c,b)&&(d.push(h[h.length-1]),d.constructor.prototype.$path.push({key:i,value:h})),each(c,function(c,e){NArray.mateDepth(a,b,e,d,h,i,c)}))},mateCondition:function(a,b,c){var d=!1,e=0;return c=NArray.parseCondition(c),each(c,function(f,g){return g.key&&"object"==typeof b?each(b,function(b,c){return d=NArray.mateKeys(b,g,a)&&NArray.mateValues(c,g,a)}):g.key||"object"!=typeof b?d=NArray.mateValues(b,g,a):each(b,function(b,c){return d=NArray.mateValues(c,g,a)}),d&&a.indexOf("whole")>=0&&(d=++e==c.length),d}),d},mateKeys:function(a,b,c){return b.key=b.key.toLocaleLowerCase(),a=String(a).toString().toLocaleLowerCase(),c.indexOf("get")>=0?a===b.key:a.indexOf(b.key)>=0},mateValues:function(value,cond,method){var result=!1,dataValue=value,condVal=cond.val;if(cond.strict||(dataValue=dataValue?dataValue.toString().toLocaleLowerCase():"",condVal=condVal?condVal.toString().toLocaleLowerCase():""),["object","function"].indexOf(typeof value)>=0&&null!=value)return result;switch(cond.mode){case"=":case"==":result=method.indexOf("get")>=0?dataValue===condVal:dataValue.indexOf(condVal)>=0;break;case"!=":result=method.indexOf("search")>=0?dataValue.indexOf(condVal)<0:dataValue!==condVal;break;default:result=eval('"'+value+'"'+cond.mode+'"'+cond.val+'"')}return result}}),NArray.extend(array,{$get:function(a,b){return NArray.mateEnter(this,a,"get",b)},$search:function(a,b){return NArray.mateEnter(this,a,"search",b)},$update:function(a){return NArray.update(this,a)},$path:[]}),window.nArray=NArray});