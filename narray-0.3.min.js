//! NArray.js
//! version : 0.3.60229.1
//! author : Na Chao
//! license : FFF
//! github.com/nachao/NArray
!function(a,b){"use strict";b(a)}(Array.prototype,function(array,undefined){"use strict";function NArray(){}function each(a,b){var c,d;for(d in a)if(a.hasOwnProperty(d)&&(c=b(d,a[d])))break;return!!c}NArray.fn=NArray.prototype={};var caseSign=["<=",">=","<",">","!=","="];Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d,e,f;if(null==this)throw new TypeError('"this" is null or not defined');if(d=Object(this),e=d.length>>>0,0===e)return-1;if(f=+b||0,1/0===Math.abs(f)&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var c,b=[];for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),NArray.extend=NArray.fn.extend=function(a,b){return b||(b=a,a=this),each(b,function(b,c){a[b]=c}),a},NArray.extend({update:function(a,b){return"undefined"!=typeof b&&a.constructor==Array&&each(a,function(c,d){"object"==typeof b?NArray.extend(d,b):"function"==typeof b&&b.call(d,a.$path[c])&&NArray.extend(d,b.call(d,a.$path[c]))}),a},unique:function(a){var b=[];return each(a,function(a,c){b.indexOf(JSON.stringify(c))<0&&b.push(c)}),b},parseCondition:function(a){var b=[];return a=a?a.toString().split(","):[],each(a,function(a,c){var d=NArray.getInquiry(c),e=c.split(d),f=e[0],g=e[1];d||g||(g=f||"",f=""),b=b.concat(NArray.getCondition(f,g.split("|"),d))}),b},getInquiry:function(a){var b="";return each(caseSign,function(c,d){return a.indexOf(d)>=0?(b=d,!0):void 0}),b},getCondition:function(a,b,c){var d=[];return b.constructor!=Array&&(b=[b]),each(b,function(b,e){d.push({key:"*"==a?"":a.trim(),val:"*"==e?"":e.trim(),mode:c||"="})}),d},mateEnter:function(a,b,c,d){var e=[];return d&&(c="whole "+c),a.constructor!=Array&&(a=[a]),e.constructor.prototype.$path=[],a&&NArray.mateDepth(c,b,a,e),e},mateDepth:function(a,b,c,d,e,f,g){var h=[],i=[];NArray.extend(i,f||[]),NArray.extend(h,e||[]),c&&[Function,Object,Array].indexOf(c.constructor)>-1&&("undefined"!=typeof g&&i.push(g),h.push(c),NArray.mateCondition(a,c,b)&&(d.push(h[h.length-1]),d.constructor.prototype.$path.push({key:i,value:h})),each(c,function(c,e){NArray.mateDepth(a,b,e,d,h,i,c)}))},mateCondition:function(a,b,c){var d=!1,e=0;return c=NArray.parseCondition(c),each(c,function(f,g){return g.key&&"object"==typeof b?each(b,function(b,c){return d=NArray.mateKeys(b,g,a)&&NArray.mateValues(c,g,a)}):g.key||"object"!=typeof b?d=NArray.mateValues(b,g,a):each(b,function(b,c){return d=NArray.mateValues(c,g,a)}),d&&a.indexOf("whole")>=0&&(d=++e==c.length),d}),d},mateKeys:function(a,b,c){return b.key=b.key.toLocaleLowerCase(),a=String(a).toString().toLocaleLowerCase(),c.indexOf("get")>=0?a===b.key:a.indexOf(b.key)>=0},mateValues:function(value,param,method){var result=!1,strValue=value?value.toString().toLocaleLowerCase():"",strVal=param.val.toString().toLocaleLowerCase();if(["object","function"].indexOf(typeof value)>=0&&null!=value)return result;switch(param.mode){case"=":result=method.indexOf("get")>=0?strValue===strVal:strValue.indexOf(strVal)>=0;break;case"!=":result=method.indexOf("search")>=0?strValue.indexOf(strVal)<0:strValue!==strVal;break;default:result=eval('"'+value+'"'+param.mode+'"'+param.val+'"')}return result}}),NArray.extend(array,{$get:function(a,b){return NArray.mateEnter(this,a,"get",b)},$search:function(a,b){return NArray.mateEnter(this,a,"search",b)},$update:function(a){return NArray.update(this,a)},$path:[]}),window.nArray=NArray});