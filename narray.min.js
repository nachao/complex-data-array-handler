//! NArray.js
//! version : 0.4/60330/1
//! author : Na Chao
//! license : FFF
//! github.com/nachao/NArray
!function(a,b){"use strict";b(a)}(Array.prototype,function(array,undefined){"use strict";function NArray(){}function each(a,b){var c,d;for(d in a)if(a.hasOwnProperty(d)&&(c=b(d,a[d])))break;return!!c}NArray.fn=NArray.prototype={},NArray.version=.4/60330/1;var caseSign=["<=",">=","<",">","!=","==","="];Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d,e,f;if(null==this)throw new TypeError('"this" is null or not defined');if(d=Object(this),e=d.length>>>0,0===e)return-1;if(f=+b||0,1/0===Math.abs(f)&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var c,b=[];for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),NArray.extend=NArray.fn.extend=function(a,b){return b||(b=a,a=this),each(b,function(b,c){a[b]=c}),a},NArray.extend({update:function(a,b){return"undefined"!=typeof b&&a.constructor==Array&&each(a,function(c,d){"object"==typeof b?NArray.extend(d,b):"function"==typeof b&&b.call(d,a.$path[c])&&NArray.extend(d,b.call(d,a.$path[c]))}),a},unique:function(a){var b=[];return each(a,function(a,c){b.indexOf(JSON.stringify(c))<0&&b.push(c)}),b},getInquiry:function(a){var b="==";return a&&each(caseSign,function(c,d){return a.indexOf(d)>=0?(b=d,!0):void 0}),b},setSpecialValue:function(a){var b="";return null!==a&&a!==undefined&&(b=a.toString().toLocaleLowerCase()),b},eachCondition:function(a){var b=[],c=[];return a.value&&"string"==typeof a.value?c=a.value.split("|"):a.value&&a.value.constructor==Array||(c=[a.value]),each(c,function(c,d){var e={key:a.key||"",val:d,mode:a.mode||"==",enable:"boolean"==typeof a.enable?a.enable:!0,strict:a.strict||!1};"*"==e.key&&(e.key=""),"*"==e.val&&(e.val=""),"string"==typeof e.key&&(e.key=e.key.trim()),"string"==typeof e.val&&(e.val=e.val.trim()),e.strict||(e.val=e.val||""),b.push(e)}),b},parseByString:function(a){var b=[],c=a?a.toString().split(","):[""];return each(c,function(a,c){var d=NArray.getInquiry(c),e=c.split(d),f={key:e[0],value:e[1],mode:d};"undefined"==typeof f.value&&(f.value=f.key||"",f.key=""),b=b.concat(NArray.eachCondition(f))}),b},parseByObject:function(a){var b=[],c=a;return c.constructor!==Array&&(c=[a]),each(c,function(a,c){b=b.concat(NArray.eachCondition(c))}),b},parseCondition:function(a){var b=[];return["string","boolean","number"].indexOf(typeof a)>=0||null===a||a===undefined?(a=NArray.setSpecialValue(a),b=NArray.parseByString(a)):(a.constructor==Array||a.constructor==Object)&&(b=NArray.parseByObject(a)),b},mateEnter:function(a,b,c,d){var e=[];return d&&(c="whole "+c),a.constructor!=Array&&(a=[a]),e.constructor.prototype.$path=[],b=NArray.parseCondition(b),a&&NArray.mateDepth(c,b,a,e),e},mateDepth:function(a,b,c,d,e,f,g){var h=[],i=[];NArray.extend(i,f||[]),NArray.extend(h,e||[]),c&&[Function,Object,Array].indexOf(c.constructor)>-1&&("undefined"!=typeof g&&i.push(g),h.push(c),NArray.mateCondition(a,c,b)&&(d.push(h[h.length-1]),d.constructor.prototype.$path.push({key:i,value:h})),each(c,function(c,e){NArray.mateDepth(a,b,e,d,h,i,c)}))},mateCondition:function(a,b,c){var d=!1,e=0;return each(c,function(f,g){return g.key&&"object"==typeof b?each(b,function(b,c){return d=NArray.mateKeys(b,g,a)&&NArray.mateValues(c,g,a)}):g.key||"object"!=typeof b?d=NArray.mateValues(b,g,a):each(b,function(b,c){return d=NArray.mateValues(c,g,a)}),d&&a.indexOf("whole")>=0&&(d=++e==c.length),d}),d},mateKeys:function(a,b,c){return b.key=b.key.toLocaleLowerCase(),a=String(a).toString().toLocaleLowerCase(),c.indexOf("get")>=0?a===b.key:a.indexOf(b.key)>=0},mateValues:function(value,cond,method){var result=!1;if(cond.strict?"search"==method&&(value=JSON.stringify(value)):(value=NArray.setSpecialValue(value),cond.val=NArray.setSpecialValue(cond.val)),!cond.enable)return result;if(["object","function"].indexOf(typeof value)>=0&&null!=value)return result;switch(cond.mode){case"=":case"==":result=method.indexOf("get")>=0?cond.strict?value===cond.val:value==cond.val:value.indexOf(cond.val)>=0;break;case"!=":result=method.indexOf("search")>=0?value.indexOf(cond.val)<0:value!==cond.val;break;default:result=eval('"'+value+'"'+cond.mode+'"'+cond.val+'"')}return result}}),NArray.extend(array,{$get:function(a,b){return NArray.mateEnter(this,a,"get",b)},$search:function(a,b){return NArray.mateEnter(this,a,"search",b)},$update:function(a){return NArray.update(this,a)},$path:[]})});